<!DOCTYPE html>
<html>
<head>
    <title>Markdown Table of Contents Generator</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="stylesheets/demo.css" />
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript" src="javascript/Markdown.Converter.js"></script>
    <script type="text/javascript" src="javascript/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="javascript/Markdown.Editor.js"></script>
</head>

<body>
<header>
    <div class="container">
        <h1>Markdown Table of Contents Generator</h1>
        <p class="lead">Grabs <code>h1</code> through <code>h3</code> headers and creates an ordered table of contents linking to them.<br /> Ideal for readmes and other nerdy documentation! <a href="#about">More Info</a></p>
    </div>
</header>
<div id="main">
    <div class="container">
        <div class="wmd-panel row">
            <div id="wmd-button-bar"></div>
            <div class="span6">
                <h4>Your Markdown goes here</h4>
                <textarea rows="8" class="wmd-input input-block-level" id="wmd-input"></textarea>
            </div>
            <div class="span6">
                <h4>Your Markdown with TOC comes out here</h4>
                <div id="wmd-preview" class="wmd-panel wmd-preview"></div>
                <textarea rows="8" id="output" class="input-block-level"></textarea>
            </div>
        </div>
       <div class="after">
        <p class="clearfix"><a href="http://daringfireball.net/projects/markdown/dingus" class=" btn btn-danger">Convert Markdown to HTML at Daring Fireball</a></p>
       <p>
        You can <a  href="https://github.com/tessa-lt/markdown_toc">view the source on GitHub</a> but only if you want to cry. </p></div>
    </div>
</div>
<div id="about">
    <div class="container">
        <h2>About</h2>
    <p>The TOC generator grabs any level 1 to 3 headings of the format </p>
        
    
<pre>
Heading Level One 
================
# Also heading Level One
Heading Level Two
----------------
## Also heading Level Two
### Heading Level Three
</pre>   
    <p>...and generates an ID from the heading text, rendering it in regular HTML, which will be parsed normally by any Markdown conversion tool or by hosts like GitHub.</p>
<pre>
&lt;h1 id="Heading-Level-One-">Heading Level One &lt;/h1>
&lt;h1 id="Also-heading-Level-One">Also heading Level One&lt;/h1>
&lt;h2 id="Heading-Level-Two">Heading Level Two&lt;/h2>
&lt;h2 id="Also-heading-Level-Two">Also heading Level Two&lt;/h2>
&lt;h3 id="Heading-Level-Three">Heading Level Three&lt;/h3>
</pre>
<p>The table of contents is generated at the top of the code as an ordered list linking to the respective headings: </p>
<pre>
1. [Heading Level One ](#Heading-Level-One-)
2. [Also heading Level One](#Also-heading-Level-One)
3. [Heading Level Two](#Heading-Level-Two)
4. [Also heading Level Two](#Also-heading-Level-Two)
5. [Heading Level Three](#Heading-Level-Three)
</pre>
        <h2><small>Possibly</small> Upcoming Features </h1>
        <ul>
            <li>Creating nested wiki-style table of contents</li>
            <li>Add option to create unordered list</li>
            <li>Allow selection of number of header levels to include</li>
        </ul>   
            </div>

    </div>
</div>

<script type="text/javascript">
    (function () {

        var createToc = function(){
            var headers = [];
            $("#wmd-preview h1, #wmd-preview h2, #wmd-preview h3").each(function(){
                headers.push($(this));
            });

            for (i = headers.length+-1; i >= 0; i--) {
              var linkInside = $(headers[i]).text();
              var linkLink = $(headers[i]).attr("id");
              var full = i+1 + ". [" + linkInside + "](#" + linkLink + ")\n";
              $("#output").prepend(full);
            }
        }

        var createOutput = function() {
            var copy = $("#wmd-preview").html();
            $("#output").html(copy);
        }

        var converter1 = Markdown.getSanitizingConverter();
        var editor1 = new Markdown.Editor(converter1);
        editor1.run();
        editor1.hooks.chain("onPreviewRefresh", function () {
           createOutput();
           createToc();
        });

    })();
</script>
</body>
</html>
